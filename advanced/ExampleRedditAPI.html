<!DOCTYPE html>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta charset="utf-8">
<title>Example: Reddit API - Redux Documents</title>
<meta name="description" content="">
<meta name="author" content="">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1">
<link rel="stylesheet" href="../assets/css/bulma.min.css">
<link rel="stylesheet" href="../assets/css/app.css">
<!--[if lt IE 9]>
<script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<link rel="shortcut icon" href="">
</head>
<body>

<nav class="columns navbar">
  <div class="column logo is-3 is-offset-1">
    <a class="is-brand" href="../index.html">
      Redux Documents
    </a>
  </div>
</nav>

<div class="book-toc notification is-warning is-hidden">
  <h3>Table of chapters &nbsp;<span class="title-close"><a class="button is-danger"> Close </a></span></h3>
  <ul class="chapter-area"><li class="chapter-item "><a href="../introduction/index.html">introduction</a>&nbsp;<a class="first-level-collapse"><span class="icon icon-expand" data-icon="expand"></span></a></li><ul class="chapter-level-1"><li class="chapter-item "><a href="../introduction/Motivation.html">Motivation</a></li><li class="chapter-item "><a href="../introduction/ThreePrinciples.html">Three Principles</a></li><li class="chapter-item "><a href="../introduction/PriorArt.html">Prior Art</a></li><li class="chapter-item "><a href="../introduction/CoreConcepts.html">Core Concepts</a></li><li class="chapter-item "><a href="../introduction/Ecosystem.html">Ecosystem</a></li><li class="chapter-item "><a href="../introduction/Examples.html">Examples</a></li></ul><li class="chapter-item "><a href="../basics/index.html">basics</a>&nbsp;<a class="first-level-collapse"><span class="icon icon-expand" data-icon="expand"></span></a></li><ul class="chapter-level-1"><li class="chapter-item "><a href="../basics/Actions.html">Actions</a></li><li class="chapter-item "><a href="../basics/Reducers.html">Reducers</a></li><li class="chapter-item "><a href="../basics/Store.html">Store</a></li><li class="chapter-item "><a href="../basics/DataFlow.html">Data Flow</a></li><li class="chapter-item "><a href="../basics/UsageWithReact.html">Usage with React</a></li><li class="chapter-item "><a href="../basics/ExampleTodoList.html">Example: Todo List</a></li></ul><li class="chapter-item "><a href="../advanced/index.html">advanced</a>&nbsp;<a class="first-level-collapse"><span class="icon icon-collapse" data-icon="collapse"></span></a></li><ul class="chapter-level-1 chapter-level-1-current"><li class="chapter-item "><a href="../advanced/AsyncActions.html">Async Actions</a></li><li class="chapter-item "><a href="../advanced/AsyncFlow.html">Async Flow</a></li><li class="chapter-item chapter-item-current"><a href="../advanced/ExampleRedditAPI.html">Example: Reddit API</a></li><li class="chapter-item "><a href="../advanced/Middleware.html">Middleware</a></li><li class="chapter-item "><a href="../advanced/NextSteps.html">Next Steps</a></li><li class="chapter-item "><a href="../advanced/UsageWithReactRouter.html">Usage with React Router</a></li></ul><li class="chapter-item "><a href="../recipes/index.html">recipes</a>&nbsp;<a class="first-level-collapse"><span class="icon icon-expand" data-icon="expand"></span></a></li><ul class="chapter-level-1"><li class="chapter-item "><a href="../recipes/ComputingDerivedData.html">Computing Derived Data</a></li><li class="chapter-item "><a href="../recipes/ImplementingUndoHistory.html">Implementing Undo History</a></li><li class="chapter-item "><a href="../recipes/IsolatingSubapps.html">Isolating Redux Sub-Apps</a></li><li class="chapter-item "><a href="../recipes/MigratingToRedux.html">Migrating to Redux</a></li><li class="chapter-item "><a href="../recipes/ReducingBoilerplate.html">Reducing Boilerplate</a></li><li class="chapter-item "><a href="../recipes/ServerRendering.html">Server Rendering</a></li><li class="chapter-item "><a href="../recipes/StructuringReducers.html">Structuring Reducers</a></li><li class="chapter-item "><a href="../recipes/UsingObjectSpreadOperator.html">Using Object Spread Operator</a></li><li class="chapter-item "><a href="../recipes/WritingTests.html">Writing Tests</a></li><li class="chapter-item "><a href="../recipes/reducers/index.html">reducers</a></li><ul class="chapter-level-2"><li class="chapter-item "><a href="../recipes/reducers/BasicReducerStructure.html">Basic Reducer Structure and State Shape</a></li><li class="chapter-item "><a href="../recipes/reducers/BeyondCombineReducers.html">Beyond `combineReducers`</a></li><li class="chapter-item "><a href="../recipes/reducers/ImmutableUpdatePatterns.html">Immutable Update Patterns</a></li><li class="chapter-item "><a href="../recipes/reducers/InitializingState.html">Initializing State</a></li><li class="chapter-item "><a href="../recipes/reducers/NormalizingStateShape.html">Normalizing State Shape</a></li><li class="chapter-item "><a href="../recipes/reducers/PrerequisiteConcepts.html">Prerequisite Reducer Concepts</a></li><li class="chapter-item "><a href="../recipes/reducers/RefactoringReducersExample.html">Refactoring Reducer Logic Using Functional Decomposition and Reducer Composition</a></li><li class="chapter-item "><a href="../recipes/reducers/ReusingReducerLogic.html">Reusing Reducer Logic</a></li><li class="chapter-item "><a href="../recipes/reducers/SplittingReducerLogic.html">Splitting Up Reducer Logic</a></li><li class="chapter-item "><a href="../recipes/reducers/UpdatingNormalizedData.html">Managing Normalized Data</a></li><li class="chapter-item "><a href="../recipes/reducers/UsingCombineReducers.html">Using `combineReducers`</a></li></ul><li class="chapter-item "><a href="../faq/index.html">faq</a>&nbsp;<a class="first-level-collapse"><span class="icon icon-expand" data-icon="expand"></span></a></li><li class="chapter-item "><a href="../faq/Actions.html">Redux FAQ: Actions</a></li><li class="chapter-item "><a href="../faq/CodeStructure.html">Redux FAQ: Code Structure</a></li><li class="chapter-item "><a href="../faq/General.html">Redux FAQ: General</a></li><li class="chapter-item "><a href="../faq/Miscellaneous.html">Redux FAQ: Miscellaneous</a></li><li class="chapter-item "><a href="../faq/OrganizingState.html">Redux FAQ: Organizing State</a></li><li class="chapter-item "><a href="../faq/Performance.html">Redux FAQ: Performance</a></li><li class="chapter-item "><a href="../faq/ReactRedux.html">Redux FAQ: React Redux</a></li><li class="chapter-item "><a href="../faq/Reducers.html">Redux FAQ: Reducers</a></li><li class="chapter-item "><a href="../faq/StoreSetup.html">Redux FAQ: Store Setup</a></li></ul><li class="chapter-item "><a href="../Troubleshooting.html">Troubleshooting</a></li><li class="chapter-item "><a href="../Glossary.html">Glossary</a></li><li class="chapter-item "><a href="../api/index.html">api</a>&nbsp;<a class="first-level-collapse"><span class="icon icon-expand" data-icon="expand"></span></a></li><ul class="chapter-level-1"><li class="chapter-item "><a href="../api/Store.html">Store</a></li><li class="chapter-item "><a href="../api/applyMiddleware.html">`applyMiddleware(...middlewares)`</a></li><li class="chapter-item "><a href="../api/bindActionCreators.html">`bindActionCreators(actionCreators, dispatch)`</a></li><li class="chapter-item "><a href="../api/combineReducers.html">`combineReducers(reducers)`</a></li><li class="chapter-item "><a href="../api/compose.html">`compose(...functions)`</a></li><li class="chapter-item "><a href="../api/createStore.html">`createStore(reducer, [preloadedState], [enhancer])`</a></li></ul><li class="chapter-item "><a href="../Feedback.html">Feedback</a></li></ul>
</div>

<div class="columns content">
  <div class="column is-2-desktop is-3-widescreen is-hidden-touch">
  </div>
  <div class="column article-container is-11-tablet is-8-desktop is-6-widescreen">
    <div class="breadcrumb-area"><a href="../index.html" class="breadcrumb-item">Home</a><span class="breadcrumb-delimiter"> &gt; </span><a href="../advanced/index.html" class="breadcrumb-item">advanced</a><span class="breadcrumb-delimiter"> &gt; </span><a href="../advanced/ExampleRedditAPI.html" class="breadcrumb-item">Example: Reddit API</a></div>
    <h1 class="article-title">Example: Reddit API</h1>
    <div class="article">
      <p>This is the complete source code of the Reddit headline fetching example we built during the <a href="README.md">advanced tutorial</a>.</p>
<h2 id="entry-point">Entry Point <a class="markdownIt-Anchor" href="#entry-point">#</a></h2>
<h4 id="indexjs"><code>index.js</code> <a class="markdownIt-Anchor" href="#indexjs">#</a></h4>
<pre class="hljs"><code><span class="hljs-keyword">import</span> <span class="hljs-string">'babel-polyfill'</span>

<span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>
<span class="hljs-keyword">import</span> { render } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-dom'</span>
<span class="hljs-keyword">import</span> Root <span class="hljs-keyword">from</span> <span class="hljs-string">'./containers/Root'</span>

render(
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Root</span> /&gt;</span>,
  document.getElementById('root')
)
</span></code></pre>
<h2 id="action-creators-and-constants">Action Creators and Constants <a class="markdownIt-Anchor" href="#action-creators-and-constants">#</a></h2>
<h4 id="actionsjs"><code>actions.js</code> <a class="markdownIt-Anchor" href="#actionsjs">#</a></h4>
<pre class="hljs"><code><span class="hljs-keyword">import</span> fetch <span class="hljs-keyword">from</span> <span class="hljs-string">'isomorphic-fetch'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> REQUEST_POSTS = <span class="hljs-string">'REQUEST_POSTS'</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> RECEIVE_POSTS = <span class="hljs-string">'RECEIVE_POSTS'</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> SELECT_SUBREDDIT = <span class="hljs-string">'SELECT_SUBREDDIT'</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> INVALIDATE_SUBREDDIT = <span class="hljs-string">'INVALIDATE_SUBREDDIT'</span>

<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">selectSubreddit</span>(<span class="hljs-params">subreddit</span>) </span>{
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">type</span>: SELECT_SUBREDDIT,
    subreddit
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">invalidateSubreddit</span>(<span class="hljs-params">subreddit</span>) </span>{
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">type</span>: INVALIDATE_SUBREDDIT,
    subreddit
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">requestPosts</span>(<span class="hljs-params">subreddit</span>) </span>{
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">type</span>: REQUEST_POSTS,
    subreddit
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">receivePosts</span>(<span class="hljs-params">subreddit, json</span>) </span>{
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">type</span>: RECEIVE_POSTS,
    subreddit,
    <span class="hljs-attr">posts</span>: json.data.children.map(<span class="hljs-function"><span class="hljs-params">child</span> =&gt;</span> child.data),
    <span class="hljs-attr">receivedAt</span>: <span class="hljs-built_in">Date</span>.now()
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetchPosts</span>(<span class="hljs-params">subreddit</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">dispatch</span> =&gt;</span> {
    dispatch(requestPosts(subreddit))
    <span class="hljs-keyword">return</span> fetch(<span class="hljs-string">`https://www.reddit.com/r/<span class="hljs-subst">${subreddit}</span>.json`</span>)
      .then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> response.json())
      .then(<span class="hljs-function"><span class="hljs-params">json</span> =&gt;</span> dispatch(receivePosts(subreddit, json)))
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">shouldFetchPosts</span>(<span class="hljs-params">state, subreddit</span>) </span>{
  <span class="hljs-keyword">const</span> posts = state.postsBySubreddit[subreddit]
  <span class="hljs-keyword">if</span> (!posts) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (posts.isFetching) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">return</span> posts.didInvalidate
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetchPostsIfNeeded</span>(<span class="hljs-params">subreddit</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-function">(<span class="hljs-params">dispatch, getState</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (shouldFetchPosts(getState(), subreddit)) {
      <span class="hljs-keyword">return</span> dispatch(fetchPosts(subreddit))
    }
  }
}
</code></pre>
<h2 id="reducers">Reducers <a class="markdownIt-Anchor" href="#reducers">#</a></h2>
<h4 id="reducersjs"><code>reducers.js</code> <a class="markdownIt-Anchor" href="#reducersjs">#</a></h4>
<pre class="hljs"><code><span class="hljs-keyword">import</span> { combineReducers } <span class="hljs-keyword">from</span> <span class="hljs-string">'redux'</span>
<span class="hljs-keyword">import</span> {
  SELECT_SUBREDDIT, INVALIDATE_SUBREDDIT,
  REQUEST_POSTS, RECEIVE_POSTS
} <span class="hljs-keyword">from</span> <span class="hljs-string">'./actions'</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">selectedSubreddit</span>(<span class="hljs-params">state = <span class="hljs-string">'reactjs'</span>, action</span>) </span>{
  <span class="hljs-keyword">switch</span> (action.type) {
  <span class="hljs-keyword">case</span> SELECT_SUBREDDIT:
    <span class="hljs-keyword">return</span> action.subreddit
  <span class="hljs-keyword">default</span>:
    <span class="hljs-keyword">return</span> state
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">posts</span>(<span class="hljs-params">state = {
  isFetching: false,
  didInvalidate: false,
  items: []
}, action</span>) </span>{
  <span class="hljs-keyword">switch</span> (action.type) {
    <span class="hljs-keyword">case</span> INVALIDATE_SUBREDDIT:
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.assign({}, state, {
        <span class="hljs-attr">didInvalidate</span>: <span class="hljs-literal">true</span>
      })
    <span class="hljs-keyword">case</span> REQUEST_POSTS:
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.assign({}, state, {
        <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">didInvalidate</span>: <span class="hljs-literal">false</span>
      })
    <span class="hljs-keyword">case</span> RECEIVE_POSTS:
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.assign({}, state, {
        <span class="hljs-attr">isFetching</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">didInvalidate</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">items</span>: action.posts,
        <span class="hljs-attr">lastUpdated</span>: action.receivedAt
      })
    <span class="hljs-keyword">default</span>:
      <span class="hljs-keyword">return</span> state
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">postsBySubreddit</span>(<span class="hljs-params">state = { }, action</span>) </span>{
  <span class="hljs-keyword">switch</span> (action.type) {
    <span class="hljs-keyword">case</span> INVALIDATE_SUBREDDIT:
    <span class="hljs-keyword">case</span> RECEIVE_POSTS:
    <span class="hljs-keyword">case</span> REQUEST_POSTS:
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.assign({}, state, {
        [action.subreddit]: posts(state[action.subreddit], action)
      })
    <span class="hljs-keyword">default</span>:
      <span class="hljs-keyword">return</span> state
  }
}

<span class="hljs-keyword">const</span> rootReducer = combineReducers({
  postsBySubreddit,
  selectedSubreddit
})

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> rootReducer
</code></pre>
<h2 id="store">Store <a class="markdownIt-Anchor" href="#store">#</a></h2>
<h4 id="configurestorejs"><code>configureStore.js</code> <a class="markdownIt-Anchor" href="#configurestorejs">#</a></h4>
<pre class="hljs"><code><span class="hljs-keyword">import</span> { createStore, applyMiddleware } <span class="hljs-keyword">from</span> <span class="hljs-string">'redux'</span>
<span class="hljs-keyword">import</span> thunkMiddleware <span class="hljs-keyword">from</span> <span class="hljs-string">'redux-thunk'</span>
<span class="hljs-keyword">import</span> createLogger <span class="hljs-keyword">from</span> <span class="hljs-string">'redux-logger'</span>
<span class="hljs-keyword">import</span> rootReducer <span class="hljs-keyword">from</span> <span class="hljs-string">'./reducers'</span>

<span class="hljs-keyword">const</span> loggerMiddleware = createLogger()

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">configureStore</span>(<span class="hljs-params">preloadedState</span>) </span>{
  <span class="hljs-keyword">return</span> createStore(
    rootReducer,
    preloadedState,
    applyMiddleware(
      thunkMiddleware,
      loggerMiddleware
    )
  )
}
</code></pre>
<h2 id="container-components">Container Components <a class="markdownIt-Anchor" href="#container-components">#</a></h2>
<h4 id="containersrootjs"><code>containers/Root.js</code> <a class="markdownIt-Anchor" href="#containersrootjs">#</a></h4>
<pre class="hljs"><code><span class="hljs-keyword">import</span> React, { Component } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>
<span class="hljs-keyword">import</span> { Provider } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-redux'</span>
<span class="hljs-keyword">import</span> configureStore <span class="hljs-keyword">from</span> <span class="hljs-string">'../configureStore'</span>
<span class="hljs-keyword">import</span> AsyncApp <span class="hljs-keyword">from</span> <span class="hljs-string">'./AsyncApp'</span>

<span class="hljs-keyword">const</span> store = configureStore()

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Root</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{
  render() {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Provider</span> <span class="hljs-attr">store</span>=<span class="hljs-string">{store}</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">AsyncApp</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Provider</span>&gt;</span></span>
    )
  }
}
</code></pre>
<h4 id="containersasyncappjs"><code>containers/AsyncApp.js</code> <a class="markdownIt-Anchor" href="#containersasyncappjs">#</a></h4>
<pre class="hljs"><code><span class="hljs-keyword">import</span> React, { Component, PropTypes } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>
<span class="hljs-keyword">import</span> { connect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-redux'</span>
<span class="hljs-keyword">import</span> { selectSubreddit, fetchPostsIfNeeded, invalidateSubreddit } <span class="hljs-keyword">from</span> <span class="hljs-string">'../actions'</span>
<span class="hljs-keyword">import</span> Picker <span class="hljs-keyword">from</span> <span class="hljs-string">'../components/Picker'</span>
<span class="hljs-keyword">import</span> Posts <span class="hljs-keyword">from</span> <span class="hljs-string">'../components/Posts'</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AsyncApp</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{
  <span class="hljs-keyword">constructor</span>(props) {
    <span class="hljs-keyword">super</span>(props)
    <span class="hljs-keyword">this</span>.handleChange = <span class="hljs-keyword">this</span>.handleChange.bind(<span class="hljs-keyword">this</span>)
    <span class="hljs-keyword">this</span>.handleRefreshClick = <span class="hljs-keyword">this</span>.handleRefreshClick.bind(<span class="hljs-keyword">this</span>)
  }

  componentDidMount() {
    <span class="hljs-keyword">const</span> { dispatch, selectedSubreddit } = <span class="hljs-keyword">this</span>.props
    dispatch(fetchPostsIfNeeded(selectedSubreddit))
  }

  componentWillReceiveProps(nextProps) {
    <span class="hljs-keyword">if</span> (nextProps.selectedSubreddit !== <span class="hljs-keyword">this</span>.props.selectedSubreddit) {
      <span class="hljs-keyword">const</span> { dispatch, selectedSubreddit } = nextProps
      dispatch(fetchPostsIfNeeded(selectedSubreddit))
    }
  }

  handleChange(nextSubreddit) {
    <span class="hljs-keyword">this</span>.props.dispatch(selectSubreddit(nextSubreddit))
    <span class="hljs-keyword">this</span>.props.dispatch(fetchPostsIfNeeded(nextSubreddit))
  }

  handleRefreshClick(e) {
    e.preventDefault()

    <span class="hljs-keyword">const</span> { dispatch, selectedSubreddit } = <span class="hljs-keyword">this</span>.props
    dispatch(invalidateSubreddit(selectedSubreddit))
    dispatch(fetchPostsIfNeeded(selectedSubreddit))
  }

  render() {
    <span class="hljs-keyword">const</span> { selectedSubreddit, posts, isFetching, lastUpdated } = <span class="hljs-keyword">this</span>.props
    <span class="hljs-keyword">return</span> (
      &lt;div&gt;
        &lt;Picker value={selectedSubreddit}
                onChange={this.handleChange}
                options={[ 'reactjs', 'frontend' ]} /&gt;
        &lt;p&gt;
          {lastUpdated &amp;&amp;
            &lt;span&gt;
              Last updated at {new Date(lastUpdated).toLocaleTimeString()}.
              {' '}
            &lt;/span&gt;
          }
          {!isFetching &amp;&amp;
            &lt;a href='#'
               onClick={this.handleRefreshClick}&gt;
              Refresh
            &lt;/a&gt;
          }
        &lt;/p&gt;
        {isFetching &amp;&amp; posts.length === 0 &amp;&amp;
          &lt;h2&gt;Loading...&lt;/h2&gt;
        }
        {!isFetching &amp;&amp; posts.length === 0 &amp;&amp;
          &lt;h2&gt;Empty.&lt;/h2&gt;
        }
        {posts.length &gt; 0 &amp;&amp;
          &lt;div style={{ opacity: isFetching ? 0.5 : 1 }}&gt;
            &lt;Posts posts={posts} /&gt;
          &lt;/div&gt;
        }
      &lt;/div&gt;
    )
  }
}

AsyncApp.propTypes = {
  selectedSubreddit: PropTypes.string.isRequired,
  posts: PropTypes.array.isRequired,
  isFetching: PropTypes.bool.isRequired,
  lastUpdated: PropTypes.number,
  dispatch: PropTypes.func.isRequired
}

function mapStateToProps(state) {
  const { selectedSubreddit, postsBySubreddit } = state
  const {
    isFetching,
    lastUpdated,
    items: posts
  } = postsBySubreddit[selectedSubreddit] || {
    isFetching: true,
    items: []
  }

  return {
    selectedSubreddit,
    posts,
    isFetching,
    lastUpdated
  }
}

export default connect(mapStateToProps)(AsyncApp)
</code></pre>
<h2 id="presentational-components">Presentational Components <a class="markdownIt-Anchor" href="#presentational-components">#</a></h2>
<h4 id="componentspickerjs"><code>components/Picker.js</code> <a class="markdownIt-Anchor" href="#componentspickerjs">#</a></h4>
<pre class="hljs"><code><span class="hljs-keyword">import</span> React, { Component, PropTypes } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Picker</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{
  render() {
    <span class="hljs-keyword">const</span> { value, onChange, options } = <span class="hljs-keyword">this</span>.props

    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>{value}<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{e</span> =&gt;</span> onChange(e.target.value)}
                value={value}&gt;
          {options.map(option =&gt;
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{option}</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{option}</span>&gt;</span>
              {option}
            <span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>)
          }
        <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>
    )
  }
}

Picker.propTypes = {
  <span class="hljs-attr">options</span>: PropTypes.arrayOf(
    PropTypes.string.isRequired
  ).isRequired,
  <span class="hljs-attr">value</span>: PropTypes.string.isRequired,
  <span class="hljs-attr">onChange</span>: PropTypes.func.isRequired
}
</code></pre>
<h4 id="componentspostsjs"><code>components/Posts.js</code> <a class="markdownIt-Anchor" href="#componentspostsjs">#</a></h4>
<pre class="hljs"><code><span class="hljs-keyword">import</span> React, { PropTypes, Component } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Posts</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{
  render() {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
        {this.props.posts.map((post, i) =&gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{i}</span>&gt;</span>{post.title}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        )}
      <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span>
    )
  }
}

Posts.propTypes = {
  <span class="hljs-attr">posts</span>: PropTypes.array.isRequired
}
</code></pre>

      
    </div>
    <div class="level article-bar is-mobile">
      <div class="level-item has-text-centered">
        <a title="previous page" class="previouse-article-link" href="../advanced/AsyncFlow.html"><span class="icon icon-previous" data-icon="previous"></span><span class="link-content">&laquo; Previous</span></a>
      </div>
      <div class="level-item has-text-centered">
        <a title="font size" class="link-item link-item-size">
          <span class="icon icon-size" data-icon="size"></span>
        </a>
      </div>
      <div class="level-item has-text-centered">
        <a title="table of content" class="link-item link-item-toc">
          <span class="icon icon-toc" data-icon="toc"></span>
        </a>
      </div>
      <div class="level-item has-text-centered">
        <a title="top" href="#">
          <span class="icon icon-up" data-icon="up"></span>
          <span class="link-content">â¤Š Top</span>
        </a>
      </div>
      <div class="level-item has-text-centered">
        <a title="next page" class="next-article-link" href="../advanced/Middleware.html"><span class="icon icon-next" data-icon="next"></span><span class="link-content">Next &raquo;</span></a>
      </div>
    </div>
  </div>
  <div class="column is-2-widescreen is-hidden">
  </div>
</div>

<div class="columns foot">
  <div class="column is-3 is-offset-9 build-by">
    Build by <a href="https://github.com/ruanyf/loppo" target="_blank">Loppo</a> 0.3.0
  </div>
</div>
<!-- SCRIPTS -->
<script>
  var LOPPO = {};
  LOPPO.current_path = 'advanced/ExampleRedditAPI.md';
  LOPPO.relative_root_path = '../';
  LOPPO.article_toc = "<ul class=\"markdownIt-TOC\">\n<li><a href=\"#entry-point\">Entry Point</a></li>\n<li><a href=\"#action-creators-and-constants\">Action Creators and Constants</a></li>\n<li><a href=\"#reducers\">Reducers</a></li>\n<li><a href=\"#store\">Store</a></li>\n<li><a href=\"#container-components\">Container Components</a></li>\n<li><a href=\"#presentational-components\">Presentational Components</a></li>\n</ul>\n";
</script>
<script src="../assets/js/app.js"></script>

</body>
</html>

